{% extends 'panel/base.html' %}

{% block title %}{{ title }}{% endblock %}

{% block content_title %}{{ title }}{% endblock %}

{% block header %}{% include 'panel/snippet_logined_header.html'%}{% endblock %}

{% block content %}
<div id="panel">
    <table class="table table-striped table-bordered table-hover">
        <tr>
            <th>ID</th>
            <th>用户</th>
            <th>状态</th>
            <th>端口</th>
            <th>密码</th>
            <th>端口状态</th>
            <th>当前流量</th>
            <th>端口操作</th>
            <th>建立日期</th>
            <th>结束日期</th>
            <th>备注</th>
        </tr>
        {% for user in users %}
        <tr>
            <td>{{ user.id }}</td>
            <td>{{ user.user.username }}</td>
            <td>{{ user.status }}</td>
            <td>{{ user.port }}</td>
            <td>{{ user.password }}</td>
            <td>{{ user.online }}</td>
            <td>{{ user.flow }}</td>
            <td>
            {% if user.online %}
                <form method="post" action="{% url 'panel:ss-op-admin' %}" role="form">
                    {% csrf_token %}
                    <button type="submit" class="btn btn-danger">关闭</button>
                    <input type="hidden" name="op" value="close_port" />
                    <input type="hidden" name="username" value="{{ user.user.username }}" />
                </form>
                <form method="post" action="{% url 'panel:ss-op-admin' %}" role="form">
                    {% csrf_token %}
                    <button type="submit" class="btn btn-default">重启</button>
                    <input type="hidden" name="op" value="reopen_port" />
                    <input type="hidden" name="username" value="{{ user.user.username }}" />
                </form>
            {% else %}
                <form method="post" action="{% url 'panel:ss-op-admin' %}" role="form">
                    {% csrf_token %}
                    <button type="submit" class="btn btn-primary">打开</button>
                    <input type="hidden" name="op" value="open_port" />
                    <input type="hidden" name="username" value="{{ user.user.username }}" />
                </form>
            {% endif %}
            </td>
            <td>{{ user.setup_date }}</td>
            <td>{{ user.end_date }}</td>
            <td>{{ user.memo }}</td>
        </tr>
        {% endfor %}
    </table>
</div>
{% endblock %}
